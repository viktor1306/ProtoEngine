# Модуль World (`src/world`)

Модуль відповідає за генерацію, підтримання та оптимізований рендеринг воксельного світу.

## Ключові Компоненти

### `Chunk` (`Chunk.hpp/cpp`)
- Базова одиниця світу розміром `32x32x32` вокселів.
- **Генерація**: Створює свої дані (вокселі) на основі шуму (Perlin Noise / Simplex).
- **Greedy Meshing**: Алгоритм стиснення 3D сітки, який об'єднує суміжні однакові грані блоків у єдиний величезний прямокутник, що в десятки разів зменшує кількість вершин.
- **Closed Chunk Meshes**: Чанки формують ідеально "закриту" коробку сітки по краях — між-чанковий culling вимкнуто для запобігання появі T-Junction дірок між чанками різної деталізації. Спідниці або додаткові перевірки сусідів більше не потрібні.
- **Ambient Occlusion**: Обчислює затемнення на вершинах блоків, аналізуючи 27 найближчих вокселів (за допомогою кешу `volumeCache`). Розширення `VoxelVertex` до 8 байт містить 4 AO-значення для кожного кута.

### `ChunkManager` (`ChunkManager.hpp/cpp`)
- Керує пулом усіх завантажених та активних чанків на мапі.
- **Безшовний світ**: Автоматично перевіряє позицію камери та динамічно вивантажує (Unload) чанки, що вийшли за межі зору, та генерує нові (Load) попереду.
- **Multithreading**: Має власний набір робочих потоків (`std::jthread` пулів) для асинхронної генерації сіток. Це повністю усуває заїкання (stuttering) під час швидкого переміщення, оскілько GPU-сітка оновлюється непомітно на фоні.

### `LOD Controller` (`LODController.hpp/cpp`)
- **Discrete Level of Detail (LOD)**: Кожен чанк обчислює свою віддаль до камери (Евклідова відстань) і призначає потрібний LOD (`0`, `1` або `2`).
- **Генерація супер-вокселів**: Якщо LOD > 0, Greedy Meshing бере великі блоки (`2x2x2` або `4x4x4`), різко зменшуючи геометрію на горизонті.
- Гістерезис (Hysteresis) впроваджений для того, щоб чанки не "мерехтіли" перемикаючи LOD-рівні туди-сюди, коли гравець стоїть рівно на межі двох зон.

### `Raycast`
- Використовується для взаємодії гравця з блоками (встановлення/руйнування).
- Реалізує алгоритм DDA крокування променем (Fast Voxel Traversal) по 3D-массиву блоків.

---

## Формат `VoxelVertex`
Завдяки Bindless системі, дані палітри та нормалей упаковано в мінімальний розмір:
- **`x, y, z`** (3 байти, uint8)
- **`normalDir, faceID`** (упаковано в uint8)
- **`paletteIndex`** (ідентифікатор кольору з 16 можливих UBO)
- **`ao0, ao1, ao2, ao3`** (4 байти AO-факторів: 0=найтемніше, 3=світле)
У сумі утворюється **8 байт** на вершину проти стандартних 48 байтів, що економить до 80% VRAM геометрії.
